{% extends 'base.html' %}
{% load lang_tags %}

{% block title %}–ú–æ–∏ —Å–Ω–∏–ø–ø–µ—Ç—ã{% endblock %}

{% block content %}
<div class="container my-4">
    <div class="text-center mb-3">
        <h5 class="fw-bold mt-4">–í–∞—à–∏ —Å–Ω–∏–ø–ø–µ—Ç—ã</h5>
    </div>

    <div class="table-responsive">
        <table class="table table-hover table-sm align-middle">
            <thead class="table-light small">
<tr>
    <th>#</th>
    <th>
        <a href="?sort=name&order={% if sort == 'name' and order == 'asc' %}desc{% else %}asc{% endif %}">
            –ù–∞–∑–≤–∞–Ω–∏–µ
            {% if sort == 'name' %}
                {% if order == 'asc' %}‚ñ≤{% else %}‚ñº{% endif %}
            {% endif %}
        </a>
    </th>
    <th>
        <a href="?sort=lang&order={% if sort == 'lang' and order == 'asc' %}desc{% else %}asc{% endif %}">
            –Ø–∑—ã–∫
            {% if sort == 'lang' %}
                {% if order == 'asc' %}‚ñ≤{% else %}‚ñº{% endif %}
            {% endif %}
        </a>
    </th>
    <th>
        <a href="?sort=creation_date&order={% if sort == 'creation_date' and order == 'asc' %}desc{% else %}asc{% endif %}">
            –°–æ–∑–¥–∞–Ω
            {% if sort == 'creation_date' %}
                {% if order == 'asc' %}‚ñ≤{% else %}‚ñº{% endif %}
            {% endif %}
        </a>
    </th>
    <th>
        <a href="?sort=updated_date&order={% if sort == 'updated_date' and order == 'asc' %}desc{% else %}asc{% endif %}">
            –û–±–Ω–æ–≤–ª—ë–Ω
            {% if sort == 'updated_date' %}
                {% if order == 'asc' %}‚ñ≤{% else %}‚ñº{% endif %}
            {% endif %}
        </a>
    </th>
    <th>
        <a href="?sort=is_public&order={% if sort == 'is_public' and order == 'asc' %}desc{% else %}asc{% endif %}">
            –ü—É–±–ª–∏—á–Ω—ã–π?
            {% if sort == 'is_public' %}
                {% if order == 'asc' %}‚ñ≤{% else %}‚ñº{% endif %}
            {% endif %}
        </a>
    </th>
    <th>
        <a href="?sort=num_comments&order={% if sort == 'num_comments' and order == 'asc' %}desc{% else %}asc{% endif %}">
            –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
            {% if sort == 'num_comments' %}
                {% if order == 'asc' %}‚ñ≤{% else %}‚ñº{% endif %}
            {% endif %}
        </a>
    </th>
    <th>
        <a href="?sort=views_count&order={% if sort == 'views_count' and order == 'asc' %}desc{% else %}asc{% endif %}">
            üëÅ –ü—Ä–æ—Å–º–æ—Ç—Ä—ã
            {% if sort == 'views_count' %}
                {% if order == 'asc' %}‚ñ≤{% else %}‚ñº{% endif %}
            {% endif %}
        </a>
    </th>
    <th class="text-center">‚úèÔ∏è</th>
    <th class="text-center">üóëÔ∏è</th>
</tr>
</thead>
<tbody class="small">
    {% for snippet in page_obj %}
    <tr>
        <td>{{ forloop.counter }}</td>
        <td>
            <a href="{% url 'MainApp:snippet-detail' snippet.id %}" class="text-decoration-none">
                {{ snippet.name }}
            </a>
        </td>
        <td>
            <i class="{% lang_icon_class snippet.lang %}"></i>
            <span>{{ snippet.get_lang_display }}</span>
        </td>
        <td>{{ snippet.creation_date|date:"d.m.Y H:i" }}</td>
        <td>{{ snippet.updated_date|date:"d.m.Y H:i" }}</td>
        <td>
            {% if snippet.public %}
                ‚úÖ
            {% else %}
                üîí
            {% endif %}
        </td>
        <td>{{ snippet.num_comments|default:"-" }}</td>
        <td>{{ snippet.views_count }}</td>
        <td class="text-center">
            <a href="{% url 'MainApp:snippet-edit' snippet.pk %}" class="btn btn-sm btn-outline-secondary">‚úé</a>
        </td>
        <td class="text-center">
            <form action="{% url 'MainApp:snippet-delete' snippet.pk %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å?');">‚úò</button>
            </form>
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="10" class="text-center text-muted">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–Ω–∏–ø–ø–µ—Ç–æ–≤.</td>
    </tr>
    {% endfor %}
</tbody>

        </table>
    </div>

    <div class="text-end mt-2 small">
        <span class="text-muted">–í—Å–µ–≥–æ: {{ snippets|length }} —Å–Ω–∏–ø–ø–µ—Ç–æ–≤</span>
    </div>

    <div class="row mt-3">
        <div class="col-6 offset-3">
            <a href="{% url 'MainApp:snippet-add' %}" class="btn btn-info w-100 btn-sm">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–Ω–∏–ø–ø–µ—Ç</a>
        </div>
    </div>

{% include 'includes/paginator.html' %}

</div>
{% endblock %}
